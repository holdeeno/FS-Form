<script>

  // Prevent forms from submitting.
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function(event) {
      event.preventDefault();
      });
    }
  }
  window.addEventListener("load", functionInit, true); 
  
  // INITIALIZE FUNCTIONS ONLOAD
  function functionInit(){  
    preventFormSubmit();
  };      


  /*
  # PROCESSING FORM -------------------------------------start--------------------------------------------
  */

  // HANDLE FORM SUBMISSIONS
  var submitCounter = 0; // submitCounter keeps track of the number of form submissions. Set equal to zero on intial form load.

  function handleFormSubmit(formObject) {

    submitCounter++;


    if (submitCounter == 1) {

      google.script.run.processInitialEntryForm(formObject);
      document.getElementById("myForm").reset();

    } else if (submitCounter == 2) {

      // This returns the matching field list array if the server-side function 'processSecondEntryForm()' returns succesfully
      function onSuccess(matchingFieldsList) { 
        console.log(matchingFieldsList);
        const matchingFieldsArray = matchingFieldsList;

        for (const element of matchingFieldsArray) {
          console.log(element);
          document.getElementById(element).parentNode.style.display = "none";
        }

        // save this array to a variable
        // iterate through the array
          // for each value in the array 
          // get the element by it's id and hide it
          // document.getElementById(" the id name ").style.display = "none";
      }
      google.script.run.withSuccessHandler(onSuccess).processSecondEntryForm(formObject);
      document.getElementById("myForm").reset();

    } else if (submitCounter == 3) {

     // google.script.run.processFinalForm(formObject);
      //document.getElementById("myForm").reset();
    }
  }

  /*
  # PROCESSING FORM ---------------------------------------end------------------------------------------
  */

</script>